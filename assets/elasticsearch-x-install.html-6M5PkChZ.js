import{_ as o}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as c,o as i,c as p,a,b as s,d as e,f as t}from"./app-pgelmVnX.js";const l={},r=a("h1",{id:"es详解-安装-elasticsearch和kibana安装",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#es详解-安装-elasticsearch和kibana安装","aria-hidden":"true"},"#"),s(" ES详解 - 安装：ElasticSearch和Kibana安装")],-1),u=a("blockquote",null,[a("p",null,"了解完ElasticSearch基础和Elastic Stack生态后，我们便可以开始学习使用ElastiSearch了。所以本文主要介绍ElasticSearch和Kibana的安装。")],-1),d=a("h2",{id:"官网相关教程",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#官网相关教程","aria-hidden":"true"},"#"),s(" 官网相关教程")],-1),k=a("blockquote",null,[a("p",null,"安装ElasticSearch还是先要看下官方网站。")],-1),m={href:"https://www.elastic.co/cn/",target:"_blank",rel:"noopener noreferrer"},v={href:"https://www.elastic.co/guide/cn/elasticsearch/guide/current/running-elasticsearch.html",target:"_blank",rel:"noopener noreferrer"},b={href:"https://www.elastic.co/cn/downloads/elasticsearch",target:"_blank",rel:"noopener noreferrer"},h={href:"https://www.elastic.co/cn/downloads/kibana",target:"_blank",rel:"noopener noreferrer"},g=t(`<p>本系列教程基于ElasticSearch 7.x版本。</p><h2 id="安装elasticsearch" tabindex="-1"><a class="header-anchor" href="#安装elasticsearch" aria-hidden="true">#</a> 安装ElasticSearch</h2><blockquote><p>ElasticSearch 是基于Java平台的，所以先要安装Java</p></blockquote><ul><li><strong>平台确认</strong></li></ul><p>这里我准备了一台Centos7虚拟机, 为方便选择后续安装的版本，所以需要看下系统版本信息。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@root ~<span class="token punctuation">]</span><span class="token comment"># uname -a</span>
Linux root <span class="token number">3.10</span>.0-862.el7.x86_64 <span class="token comment">#1 SMP Fri Apr 20 16:44:24 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>安装Java</strong></li></ul>`,7),f={href:"http://www.java.com",target:"_blank",rel:"noopener noreferrer"},x=t(`<div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@root ~<span class="token punctuation">]</span><span class="token comment"># java --version</span>
openjdk <span class="token number">14.0</span>.2 <span class="token number">2020</span>-07-14
OpenJDK Runtime Environment <span class="token number">20.3</span> <span class="token punctuation">(</span>slowdebug build <span class="token number">14.0</span>.2+12<span class="token punctuation">)</span>
OpenJDK <span class="token number">64</span>-Bit Server VM <span class="token number">20.3</span> <span class="token punctuation">(</span>slowdebug build <span class="token number">14.0</span>.2+12, mixed mode, sharing<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>下载ElasticSearch</strong></li></ul>`,2),_={href:"https://www.elastic.co/cn/downloads/elasticsearch",target:"_blank",rel:"noopener noreferrer"},w=t(`<p>比如可以通过curl下载</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@root opt<span class="token punctuation">]</span><span class="token comment"># curl -O https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.12.0-linux-x86_64.tar.gz</span>
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>解压</strong></li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@root opt<span class="token punctuation">]</span><span class="token comment"># tar zxvf /opt/elasticsearch-7.12.0-linux-x86_64.tar.gz </span>
<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>root@root opt<span class="token punctuation">]</span><span class="token comment"># ll | grep elasticsearch</span>
drwxr-xr-x  <span class="token number">9</span> root root      <span class="token number">4096</span> Mar <span class="token number">18</span> <span class="token number">14</span>:21 elasticsearch-7.12.0
-rw-r--r--  <span class="token number">1</span> root root <span class="token number">327497331</span> Apr  <span class="token number">5</span> <span class="token number">21</span>:05 elasticsearch-7.12.0-linux-x86_64.tar.gz
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>增加elasticSearch用户</strong></li></ul><p>必须创建一个非root用户来运行ElasticSearch(ElasticSearch5及以上版本，基于安全考虑，强制规定不能以root身份运行。)</p><p>如果你使用root用户来启动ElasticSearch，则会有如下错误信息：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@root opt<span class="token punctuation">]</span><span class="token comment"># cd elasticsearch-7.12.0/</span>
<span class="token punctuation">[</span>root@root elasticsearch-7.12.0<span class="token punctuation">]</span><span class="token comment"># ./bin/elasticsearch</span>
<span class="token punctuation">[</span><span class="token number">2021</span>-04-05T21:36:46,510<span class="token punctuation">]</span><span class="token punctuation">[</span>ERROR<span class="token punctuation">]</span><span class="token punctuation">[</span>o.e.b.ElasticsearchUncaughtExceptionHandler<span class="token punctuation">]</span> <span class="token punctuation">[</span>root<span class="token punctuation">]</span> uncaught exception <span class="token keyword">in</span> thread <span class="token punctuation">[</span>main<span class="token punctuation">]</span>
org.elasticsearch.bootstrap.StartupException: java.lang.RuntimeException: can not run elasticsearch as root
        at org.elasticsearch.bootstrap.Elasticsearch.init<span class="token punctuation">(</span>Elasticsearch.java:163<span class="token punctuation">)</span> ~<span class="token punctuation">[</span>elasticsearch-7.12.0.jar:7.12.0<span class="token punctuation">]</span>
        at org.elasticsearch.bootstrap.Elasticsearch.execute<span class="token punctuation">(</span>Elasticsearch.java:150<span class="token punctuation">)</span> ~<span class="token punctuation">[</span>elasticsearch-7.12.0.jar:7.12.0<span class="token punctuation">]</span>
        at org.elasticsearch.cli.EnvironmentAwareCommand.execute<span class="token punctuation">(</span>EnvironmentAwareCommand.java:75<span class="token punctuation">)</span> ~<span class="token punctuation">[</span>elasticsearch-7.12.0.jar:7.12.0<span class="token punctuation">]</span>
        at org.elasticsearch.cli.Command.mainWithoutErrorHandling<span class="token punctuation">(</span>Command.java:116<span class="token punctuation">)</span> ~<span class="token punctuation">[</span>elasticsearch-cli-7.12.0.jar:7.12.0<span class="token punctuation">]</span>
        at org.elasticsearch.cli.Command.main<span class="token punctuation">(</span>Command.java:79<span class="token punctuation">)</span> ~<span class="token punctuation">[</span>elasticsearch-cli-7.12.0.jar:7.12.0<span class="token punctuation">]</span>
        at org.elasticsearch.bootstrap.Elasticsearch.main<span class="token punctuation">(</span>Elasticsearch.java:115<span class="token punctuation">)</span> ~<span class="token punctuation">[</span>elasticsearch-7.12.0.jar:7.12.0<span class="token punctuation">]</span>
        at org.elasticsearch.bootstrap.Elasticsearch.main<span class="token punctuation">(</span>Elasticsearch.java:81<span class="token punctuation">)</span> ~<span class="token punctuation">[</span>elasticsearch-7.12.0.jar:7.12.0<span class="token punctuation">]</span>
Caused by: java.lang.RuntimeException: can not run elasticsearch as root
        at org.elasticsearch.bootstrap.Bootstrap.initializeNatives<span class="token punctuation">(</span>Bootstrap.java:101<span class="token punctuation">)</span> ~<span class="token punctuation">[</span>elasticsearch-7.12.0.jar:7.12.0<span class="token punctuation">]</span>
        at org.elasticsearch.bootstrap.Bootstrap.setup<span class="token punctuation">(</span>Bootstrap.java:168<span class="token punctuation">)</span> ~<span class="token punctuation">[</span>elasticsearch-7.12.0.jar:7.12.0<span class="token punctuation">]</span>
        at org.elasticsearch.bootstrap.Bootstrap.init<span class="token punctuation">(</span>Bootstrap.java:397<span class="token punctuation">)</span> ~<span class="token punctuation">[</span>elasticsearch-7.12.0.jar:7.12.0<span class="token punctuation">]</span>
        at org.elasticsearch.bootstrap.Elasticsearch.init<span class="token punctuation">(</span>Elasticsearch.java:159<span class="token punctuation">)</span> ~<span class="token punctuation">[</span>elasticsearch-7.12.0.jar:7.12.0<span class="token punctuation">]</span>
        <span class="token punctuation">..</span>. <span class="token number">6</span> <span class="token function">more</span>
uncaught exception <span class="token keyword">in</span> thread <span class="token punctuation">[</span>main<span class="token punctuation">]</span>
java.lang.RuntimeException: can not run elasticsearch as root
        at org.elasticsearch.bootstrap.Bootstrap.initializeNatives<span class="token punctuation">(</span>Bootstrap.java:101<span class="token punctuation">)</span>
        at org.elasticsearch.bootstrap.Bootstrap.setup<span class="token punctuation">(</span>Bootstrap.java:168<span class="token punctuation">)</span>
        at org.elasticsearch.bootstrap.Bootstrap.init<span class="token punctuation">(</span>Bootstrap.java:397<span class="token punctuation">)</span>
        at org.elasticsearch.bootstrap.Elasticsearch.init<span class="token punctuation">(</span>Elasticsearch.java:159<span class="token punctuation">)</span>
        at org.elasticsearch.bootstrap.Elasticsearch.execute<span class="token punctuation">(</span>Elasticsearch.java:150<span class="token punctuation">)</span>
        at org.elasticsearch.cli.EnvironmentAwareCommand.execute<span class="token punctuation">(</span>EnvironmentAwareCommand.java:75<span class="token punctuation">)</span>
        at org.elasticsearch.cli.Command.mainWithoutErrorHandling<span class="token punctuation">(</span>Command.java:116<span class="token punctuation">)</span>
        at org.elasticsearch.cli.Command.main<span class="token punctuation">(</span>Command.java:79<span class="token punctuation">)</span>
        at org.elasticsearch.bootstrap.Elasticsearch.main<span class="token punctuation">(</span>Elasticsearch.java:115<span class="token punctuation">)</span>
        at org.elasticsearch.bootstrap.Elasticsearch.main<span class="token punctuation">(</span>Elasticsearch.java:81<span class="token punctuation">)</span>
For complete error details, refer to the log at /opt/elasticsearch-7.12.0/logs/elasticsearch.log
<span class="token number">2021</span>-04-05 <span class="token number">13</span>:36:46,979269 UTC <span class="token punctuation">[</span><span class="token number">8846</span><span class="token punctuation">]</span> INFO  Main.cc@106 Parent process died - ML controller exiting
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>所以我们增加一个独立的elasticsearch用户来运行</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 增加elasticsearch用户</span>
<span class="token punctuation">[</span>root@root elasticsearch-7.12.0<span class="token punctuation">]</span><span class="token comment"># useradd elasticsearch</span>
<span class="token punctuation">[</span>root@root elasticsearch-7.12.0<span class="token punctuation">]</span><span class="token comment"># passwd elasticsearch</span>
Changing password <span class="token keyword">for</span> user elasticsearch.
New password: 
BAD PASSWORD: The password contains the user name <span class="token keyword">in</span> some form
Retype new password: 
passwd: all authentication tokens updated successfully.

<span class="token comment"># 修改目录权限至新增的elasticsearch用户</span>
<span class="token punctuation">[</span>root@root elasticsearch-7.12.0<span class="token punctuation">]</span><span class="token comment"># chown -R elasticsearch /opt/elasticsearch-7.12.0</span>
<span class="token comment"># 增加data和log存放区，并赋予elasticsearch用户权限</span>
<span class="token punctuation">[</span>root@root elasticsearch-7.12.0<span class="token punctuation">]</span><span class="token comment"># mkdir -p /data/es</span>
<span class="token punctuation">[</span>root@root elasticsearch-7.12.0<span class="token punctuation">]</span><span class="token comment"># chown -R elasticsearch /data/es</span>
<span class="token punctuation">[</span>root@root elasticsearch-7.12.0<span class="token punctuation">]</span><span class="token comment"># mkdir -p /var/log/es</span>
<span class="token punctuation">[</span>root@root elasticsearch-7.12.0<span class="token punctuation">]</span><span class="token comment"># chown -R elasticsearch /var/log/es</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后修改上述的data和log路径，<code>vi /opt/elasticsearch-7.12.0/config/elasticsearch.yml</code></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># ----------------------------------- Paths ------------------------------------</span>
<span class="token comment">#</span>
<span class="token comment"># Path to directory where to store the data (separate multiple locations by comma):</span>
<span class="token comment">#</span>
path.data: /data/es
<span class="token comment">#</span>
<span class="token comment"># Path to log files:</span>
<span class="token comment">#</span>
path.logs: /var/log/es
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>修改Linux系统的限制配置</strong></li></ul><ol><li>修改系统中允许应用最多创建多少文件等的限制权限。Linux默认来说，一般限制应用最多创建的文件是65535个。但是ES至少需要65536的文件创建权限。</li><li>修改系统中允许用户启动的进程开启多少个线程。默认的Linux限制root用户开启的进程可以开启任意数量的线程，其他用户开启的进程可以开启1024个线程。必须修改限制数为4096+。因为ES至少需要4096的线程池预备。ES在5.x版本之后，强制要求在linux中不能使用root用户启动ES进程。所以必须使用其他用户启动ES进程才可以。</li><li>Linux低版本内核为线程分配的内存是128K。4.x版本的内核分配的内存更大。如果虚拟机的内存是1G，最多只能开启3000+个线程数。至少为虚拟机分配1.5G以上的内存。</li></ol><p>修改如下配置</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@root elasticsearch-7.12.0<span class="token punctuation">]</span><span class="token comment"># vi /etc/security/limits.conf</span>

elasticsearch soft nofile <span class="token number">65536</span>
elasticsearch hard nofile <span class="token number">65536</span>
elasticsearch soft nproc <span class="token number">4096</span>
elasticsearch hard nproc <span class="token number">4096</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>启动ElasticSearch</strong></li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@root elasticsearch-7.12.0<span class="token punctuation">]</span><span class="token comment"># su elasticsearch</span>
<span class="token punctuation">[</span>elasticsearch@root elasticsearch-7.12.0<span class="token punctuation">]</span>$ ./bin/elasticsearch <span class="token parameter variable">-d</span>
<span class="token punctuation">[</span><span class="token number">2021</span>-04-05T22:03:38,332<span class="token punctuation">]</span><span class="token punctuation">[</span>INFO <span class="token punctuation">]</span><span class="token punctuation">[</span>o.e.n.Node               <span class="token punctuation">]</span> <span class="token punctuation">[</span>root<span class="token punctuation">]</span> version<span class="token punctuation">[</span><span class="token number">7.12</span>.0<span class="token punctuation">]</span>, pid<span class="token punctuation">[</span><span class="token number">13197</span><span class="token punctuation">]</span>, build<span class="token punctuation">[</span>default/tar/78722783c38caa25a70982b5b042074cde5d3b3a/2021-03-18T06:17:15.410153305Z<span class="token punctuation">]</span>, OS<span class="token punctuation">[</span>Linux/3.10.0-862.el7.x86_64/amd64<span class="token punctuation">]</span>, JVM<span class="token punctuation">[</span>AdoptOpenJDK/OpenJDK <span class="token number">64</span>-Bit Server VM/15.0.1/15.0.1+9<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token number">2021</span>-04-05T22:03:38,348<span class="token punctuation">]</span><span class="token punctuation">[</span>INFO <span class="token punctuation">]</span><span class="token punctuation">[</span>o.e.n.Node               <span class="token punctuation">]</span> <span class="token punctuation">[</span>root<span class="token punctuation">]</span> JVM home <span class="token punctuation">[</span>/opt/elasticsearch-7.12.0/jdk<span class="token punctuation">]</span>, using bundled JDK <span class="token punctuation">[</span>true<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token number">2021</span>-04-05T22:03:38,348<span class="token punctuation">]</span><span class="token punctuation">[</span>INFO <span class="token punctuation">]</span><span class="token punctuation">[</span>o.e.n.Node               <span class="token punctuation">]</span> <span class="token punctuation">[</span>root<span class="token punctuation">]</span> JVM arguments <span class="token punctuation">[</span>-Xshare:auto, <span class="token parameter variable">-Des.networkaddress.cache.ttl</span><span class="token operator">=</span><span class="token number">60</span>, <span class="token parameter variable">-Des.networkaddress.cache.negative.ttl</span><span class="token operator">=</span><span class="token number">10</span>, -XX:+AlwaysPreTouch, -Xss1m, <span class="token parameter variable">-Djava.awt.headless</span><span class="token operator">=</span>true, <span class="token parameter variable">-Dfile.encoding</span><span class="token operator">=</span>UTF-8, <span class="token parameter variable">-Djna.nosys</span><span class="token operator">=</span>true, -XX:-OmitStackTraceInFastThrow, -XX:+ShowCodeDetailsInExceptionMessages, <span class="token parameter variable">-Dio.netty.noUnsafe</span><span class="token operator">=</span>true, <span class="token parameter variable">-Dio.netty.noKeySetOptimization</span><span class="token operator">=</span>true, <span class="token parameter variable">-Dio.netty.recycler.maxCapacityPerThread</span><span class="token operator">=</span><span class="token number">0</span>, <span class="token parameter variable">-Dio.netty.allocator.numDirectArenas</span><span class="token operator">=</span><span class="token number">0</span>, <span class="token parameter variable">-Dlog4j.shutdownHookEnabled</span><span class="token operator">=</span>false, <span class="token parameter variable">-Dlog4j2.disable.jmx</span><span class="token operator">=</span>true, <span class="token parameter variable">-Djava.locale.providers</span><span class="token operator">=</span>SPI,COMPAT, --add-opens<span class="token operator">=</span>java.base/java.io<span class="token operator">=</span>ALL-UNNAMED, -XX:+UseG1GC, <span class="token parameter variable">-Djava.io.tmpdir</span><span class="token operator">=</span>/tmp/elasticsearch-17264135248464897093, -XX:+HeapDumpOnOutOfMemoryError, <span class="token parameter variable">-XX:HeapDumpPath</span><span class="token operator">=</span>data, <span class="token parameter variable">-XX:ErrorFile</span><span class="token operator">=</span>logs/hs_err_pid%p.log, -Xlog:gc*,gc+age<span class="token operator">=</span>trace,safepoint:file<span class="token operator">=</span>logs/gc.log:utctime,pid,tags:filecount<span class="token operator">=</span><span class="token number">32</span>,filesize<span class="token operator">=</span>64m, -Xms1894m, -Xmx1894m, <span class="token parameter variable">-XX:MaxDirectMemorySize</span><span class="token operator">=</span><span class="token number">993001472</span>, <span class="token parameter variable">-XX:G1HeapRegionSize</span><span class="token operator">=</span>4m, <span class="token parameter variable">-XX:InitiatingHeapOccupancyPercent</span><span class="token operator">=</span><span class="token number">30</span>, <span class="token parameter variable">-XX:G1ReservePercent</span><span class="token operator">=</span><span class="token number">15</span>, <span class="token parameter variable">-Des.path.home</span><span class="token operator">=</span>/opt/elasticsearch-7.12.0, <span class="token parameter variable">-Des.path.conf</span><span class="token operator">=</span>/opt/elasticsearch-7.12.0/config, <span class="token parameter variable">-Des.distribution.flavor</span><span class="token operator">=</span>default, <span class="token parameter variable">-Des.distribution.type</span><span class="token operator">=</span>tar, <span class="token parameter variable">-Des.bundled_jdk</span><span class="token operator">=</span>true<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>查看安装是否成功</strong></li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@root ~<span class="token punctuation">]</span><span class="token comment"># netstat -ntlp | grep 9200</span>
tcp6       <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">127.0</span>.0.1:9200          :::*                    LISTEN      <span class="token number">13549</span>/java          
tcp6       <span class="token number">0</span>      <span class="token number">0</span> ::1:9200                :::*                    LISTEN      <span class="token number">13549</span>/java          
<span class="token punctuation">[</span>root@root ~<span class="token punctuation">]</span><span class="token comment"># curl 127.0.0.1:9200</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;name&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;root&quot;</span>,
  <span class="token string">&quot;cluster_name&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;elasticsearch&quot;</span>,
  <span class="token string">&quot;cluster_uuid&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;ihttW8b2TfWSkwf_YgPH2Q&quot;</span>,
  <span class="token string">&quot;version&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;number&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;7.12.0&quot;</span>,
    <span class="token string">&quot;build_flavor&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;default&quot;</span>,
    <span class="token string">&quot;build_type&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;tar&quot;</span>,
    <span class="token string">&quot;build_hash&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;78722783c38caa25a70982b5b042074cde5d3b3a&quot;</span>,
    <span class="token string">&quot;build_date&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;2021-03-18T06:17:15.410153305Z&quot;</span>,
    <span class="token string">&quot;build_snapshot&quot;</span> <span class="token builtin class-name">:</span> false,
    <span class="token string">&quot;lucene_version&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;8.8.0&quot;</span>,
    <span class="token string">&quot;minimum_wire_compatibility_version&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;6.8.0&quot;</span>,
    <span class="token string">&quot;minimum_index_compatibility_version&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;6.0.0-beta1&quot;</span>
  <span class="token punctuation">}</span>,
  <span class="token string">&quot;tagline&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;You Know, for Search&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="安装kibana" tabindex="-1"><a class="header-anchor" href="#安装kibana" aria-hidden="true">#</a> 安装Kibana</h2><blockquote><p>Kibana是界面化的查询数据的工具，下载时尽量下载与ElasicSearch一致的版本。</p></blockquote><ul><li><strong>下载Kibana</strong></li></ul>`,23),E={href:"https://www.elastic.co/cn/downloads/kibana",target:"_blank",rel:"noopener noreferrer"},y=t(`<ul><li><strong>解压</strong></li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@root opt<span class="token punctuation">]</span><span class="token comment"># tar -vxzf kibana-7.12.0-linux-x86_64.tar.gz</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><strong>使用elasticsearch用户权限</strong></li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@root opt<span class="token punctuation">]</span><span class="token comment"># chown -R elasticsearch /opt/kibana-7.12.0-linux-x86_64</span>
<span class="token comment">#配置Kibana的远程访问</span>
<span class="token punctuation">[</span>root@root opt<span class="token punctuation">]</span><span class="token comment"># vi /opt/kibana-7.12.0-linux-x86_64/config/kibana.yml</span>
server.host: <span class="token number">0.0</span>.0.0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>启动</strong></li></ul><p>需要切换至elasticsearch用户</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@root opt<span class="token punctuation">]</span><span class="token comment"># su elasticsearch</span>
<span class="token punctuation">[</span>elasticsearch@root opt<span class="token punctuation">]</span>$ <span class="token builtin class-name">cd</span> /opt/kibana-7.12.0-linux-x86_64/
<span class="token punctuation">[</span>elasticsearch@root kibana-7.12.0-linux-x86_64<span class="token punctuation">]</span>$ ./bin/kibana
  log   <span class="token punctuation">[</span><span class="token number">22</span>:30:22.185<span class="token punctuation">]</span> <span class="token punctuation">[</span>info<span class="token punctuation">]</span><span class="token punctuation">[</span>plugins-service<span class="token punctuation">]</span> Plugin <span class="token string">&quot;osquery&quot;</span> is disabled.
  log   <span class="token punctuation">[</span><span class="token number">22</span>:30:22.283<span class="token punctuation">]</span> <span class="token punctuation">[</span>warning<span class="token punctuation">]</span><span class="token punctuation">[</span>config<span class="token punctuation">]</span><span class="token punctuation">[</span>deprecation<span class="token punctuation">]</span> Config key <span class="token punctuation">[</span>monitoring.cluster_alerts.email_notifications.email_address<span class="token punctuation">]</span> will be required <span class="token keyword">for</span> email notifications to work <span class="token keyword">in</span> <span class="token number">8.0</span>.&quot;
  log   <span class="token punctuation">[</span><span class="token number">22</span>:30:22.482<span class="token punctuation">]</span> <span class="token punctuation">[</span>info<span class="token punctuation">]</span><span class="token punctuation">[</span>plugins-system<span class="token punctuation">]</span> Setting up <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span> plugins: <span class="token punctuation">[</span>taskManager,licensing,globalSearch,globalSearchProviders,banners,code,usageCollection,xpackLegacy,telemetryCollectionManager,telemetry,telemetryCollectionXpack,kibanaUsageCollection,securityOss,share,newsfeed,mapsLegacy,kibanaLegacy,translations,legacyExport,embeddable,uiActionsEnhanced,expressions,charts,esUiShared,bfetch,data,home,observability,console,consoleExtensions,apmOss,searchprofiler,painlessLab,grokdebugger,management,indexPatternManagement,advancedSettings,fileUpload,savedObjects,visualizations,visTypeVislib,visTypeVega,visTypeTimelion,features,licenseManagement,watcher,canvas,visTypeTagcloud,visTypeTable,visTypeMetric,visTypeMarkdown,tileMap,regionMap,visTypeXy,graph,timelion,dashboard,dashboardEnhanced,visualize,visTypeTimeseries,inputControlVis,discover,discoverEnhanced,savedObjectsManagement,spaces,security,savedObjectsTagging,maps,lens,reporting,lists,encryptedSavedObjects,dashboardMode,dataEnhanced,cloud,upgradeAssistant,snapshotRestore,fleet,indexManagement,rollup,remoteClusters,crossClusterReplication,indexLifecycleManagement,enterpriseSearch,beatsManagement,transform,ingestPipelines,eventLog,actions,alerts,triggersActionsUi,stackAlerts,ml,securitySolution,case,infra,monitoring,logstash,apm,uptime<span class="token punctuation">]</span>
  log   <span class="token punctuation">[</span><span class="token number">22</span>:30:22.483<span class="token punctuation">]</span> <span class="token punctuation">[</span>info<span class="token punctuation">]</span><span class="token punctuation">[</span>plugins<span class="token punctuation">]</span><span class="token punctuation">[</span>taskManager<span class="token punctuation">]</span> TaskManager is identified by the Kibana UUID: xxxxxx
  <span class="token punctuation">..</span>.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果是后台启动：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>elasticsearch@root kibana-7.12.0-linux-x86_64<span class="token punctuation">]</span>$ <span class="token function">nohup</span> ./bin/kibana <span class="token operator">&amp;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><strong>界面访问</strong></li></ul><figure><img src="https://www.pdai.tech/images/db/es/es-install-1.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>可以导入simple data</p><figure><img src="https://www.pdai.tech/images/db/es/es-install-2.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>查看数据</p><figure><img src="https://www.pdai.tech/images/db/es/es-install-3.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h2 id="配置密码访问" tabindex="-1"><a class="header-anchor" href="#配置密码访问" aria-hidden="true">#</a> 配置密码访问</h2>`,16),q={href:"https://www.elastic.co/guide/en/elasticsearch/reference/7.12/security-minimal-setup.html",target:"_blank",rel:"noopener noreferrer"},j=t('<ol><li>停止kibana和elasticsearch服务</li><li>将<code>xpack.security.enabled</code>设置添加到ES_PATH_CONF/elasticsearch.yml文件并将值设置为true</li><li>启动elasticsearch (<code>./bin/elasticsearch -d</code>)</li><li>执行如下密码设置器，<code>./bin/elasticsearch-setup-passwords interactive</code>来设置各个组件的密码</li><li>将elasticsearch.username设置添加到KIB_PATH_CONF/kibana.yml 文件并将值设置给elastic用户： <code>elasticsearch.username: &quot;elastic&quot;</code></li><li>创建kibana keystore, <code>./bin/kibana-keystore create</code></li><li>在kibana keystore 中添加密码 <code>./bin/kibana-keystore add elasticsearch.password</code></li><li>重启kibana 服务即可 <code>nohup ./bin/kibana &amp;</code></li></ol><p>然后就可以使用密码登录了：</p><figure><img src="https://www.pdai.tech/images/db/es/es-install-4.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>',3);function S(T,C){const n=c("ExternalLinkIcon");return i(),p("div",null,[r,u,d,k,a("ul",null,[a("li",null,[a("a",m,[s("官方网站在新窗口打开"),e(n)])]),a("li",null,[a("a",v,[s("官方2.x中文教程中安装教程在新窗口打开"),e(n)])]),a("li",null,[a("a",b,[s("官方ElasticSearch下载地址在新窗口打开"),e(n)])]),a("li",null,[a("a",h,[s("官方Kibana下载地址在新窗口打开"),e(n)])])]),g,a("p",null,[s("安装 Elasticsearch 之前，你需要先安装一个较新的版本的 Java，最好的选择是，你可以从 "),a("a",f,[s("www.java.com在新窗口打开"),e(n)]),s(" 获得官方提供的最新版本的 Java。安装以后，确认是否安装成功：")]),x,a("p",null,[s("从"),a("a",_,[s("这里在新窗口打开"),e(n)]),s("下载ElasticSearch")]),w,a("p",null,[s("从"),a("a",E,[s("这里在新窗口打开"),e(n)]),s("下载Kibana")]),y,a("blockquote",null,[a("p",null,[s("使用基本许可证时，默认情况下禁用Elasticsearch安全功能。由于我测试环境是放在公网上的，所以需要设置下密码访问。相关文档可以参考"),a("a",q,[s("这里在新窗口打开"),e(n)])])]),j])}const M=o(l,[["render",S],["__file","elasticsearch-x-install.html.vue"]]);export{M as default};
